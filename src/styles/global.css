@import 'tailwindcss';
@import 'katex/dist/katex.css';

/* https://fontsource.org/fonts/jetbrains-mono/install */
/* jetbrains-mono-latin-wght-normal */
@font-face {
  font-family: 'JetBrains Mono Variable';
  font-style: normal;
  font-display: swap;
  font-weight: 100 800;
  src: url(@fontsource-variable/jetbrains-mono/files/jetbrains-mono-latin-wght-normal.woff2)
    format('woff2-variations');
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308,
    U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

/* https://fontsource.org/fonts/inter/install */
/* inter-latin-wght-normal — proportional font for prose reading */
@font-face {
  font-family: 'Inter Variable';
  font-style: normal;
  font-display: swap;
  font-weight: 100 900;
  src: url(@fontsource-variable/inter/files/inter-latin-wght-normal.woff2)
    format('woff2-variations');
  unicode-range:
    U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308,
    U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@theme {
  --color-accent: var(--theme-accent);
  --color-foreground: var(--theme-foreground);
  --color-background: var(--theme-background);
  --color-heading1: var(--theme-heading1);
  --color-heading2: var(--theme-heading2);
  --color-heading3: var(--theme-heading3);
  --color-heading4: var(--theme-heading4);
  --color-heading5: var(--theme-heading5);
  --color-heading6: var(--theme-heading6);
  --color-list: var(--theme-list);
  --color-link: var(--theme-link);
  --color-separator: var(--theme-separator);
  --color-note: var(--theme-note);
  --color-tip: var(--theme-tip);
  --color-important: var(--theme-important);
  --color-caution: var(--theme-caution);
  --color-warning: var(--theme-warning);
  --color-blue: var(--theme-blue);
  --color-green: var(--theme-green);
  --color-red: var(--theme-red);
  --color-yellow: var(--theme-yellow);
  --color-magenta: var(--theme-magenta);
  --color-cyan: var(--theme-cyan);
  --default-font-family: var(--theme-font), monospace;
  --default-mono-font-family: var(--theme-font), monospace;
}

/* ==========================================================================
   Kapsicum Visual Language — CSS Variables
   ========================================================================== */

/* Ember Chamber (dark) — firelight amber */
:root[data-theme="kanagawa-dragon"] {
  color-scheme: dark;

  /* Atmosphere */
  --kap-bg-from: #0C0804;
  --kap-bg-to: #14100A;

  /* Surfaces — no haze, just a warm tint */
  --kap-surface-bg: rgba(224, 136, 64, 0.035);
  --kap-surface-blur: 8px;

  /* Borders — amber ember glow on right, deep char on bottom */
  --kap-border-right: rgba(224, 136, 64, 0.3);
  --kap-border-bottom: rgba(40, 24, 10, 0.7);
  --kap-border-top: rgba(245, 237, 228, 0.06);
  --kap-border-left: rgba(245, 237, 228, 0.03);

  /* Shadows — deep and warm, not diffuse */
  --kap-shadow-card:
    0 1px 3px rgba(0,0,0,0.5),
    0 4px 16px rgba(0,0,0,0.35);
  --kap-shadow-button:
    0 2px 8px rgba(12,8,4,0.6),
    0 4px 12px rgba(224,136,64,0.12);

  /* Text */
  --kap-text-shadow-title: 1px 1px 2px rgba(0,0,0,0.7);
  --kap-text-secondary: rgba(245,237,228,0.7);
  --kap-text-tertiary: rgba(245,237,228,0.5);
  --kap-text-muted: rgba(245,237,228,0.3);

  /* Buttons — amber gradient */
  --kap-btn-gradient: linear-gradient(135deg, #E89050 0%, #C07030 100%);
  --kap-btn-hover-shadow:
    0 4px 16px rgba(12,8,4,0.5),
    0 8px 24px rgba(224,136,64,0.2);
  --kap-btn-active-shadow: inset 0 2px 4px rgba(0,0,0,0.5);

  /* Atmosphere orbs — warm amber nebulae */
  --kap-orb-1: radial-gradient(ellipse 600px 400px at 10% 15%, rgba(224,136,64,0.05), transparent 70%);
  --kap-orb-2: radial-gradient(ellipse 500px 500px at 90% 50%, rgba(200,152,80,0.035), transparent 70%);
  --kap-orb-3: radial-gradient(ellipse 400px 300px at 50% 85%, rgba(184,96,32,0.03), transparent 70%);
}

/* Grayscale (mid) — pure monochrome, no color */
:root[data-theme="github-dark-dimmed"] {
  color-scheme: dark;

  /* Atmosphere */
  --kap-bg-from: #2A2A2A;
  --kap-bg-to: #252525;

  /* Surfaces — neutral, no tint */
  --kap-surface-bg: rgba(255, 255, 255, 0.03);
  --kap-surface-blur: 8px;

  /* Borders — pure neutral, slightly higher contrast */
  --kap-border-right: rgba(255, 255, 255, 0.15);
  --kap-border-bottom: rgba(0, 0, 0, 0.45);
  --kap-border-top: rgba(255, 255, 255, 0.08);
  --kap-border-left: rgba(255, 255, 255, 0.04);

  /* Shadows — deep neutral */
  --kap-shadow-card:
    0 1px 3px rgba(0,0,0,0.4),
    0 4px 16px rgba(0,0,0,0.25);
  --kap-shadow-button:
    0 2px 8px rgba(0,0,0,0.4),
    0 4px 12px rgba(0,0,0,0.15);

  /* Text */
  --kap-text-shadow-title: 1px 1px 2px rgba(0,0,0,0.5);
  --kap-text-secondary: rgba(216,216,216,0.7);
  --kap-text-tertiary: rgba(216,216,216,0.5);
  --kap-text-muted: rgba(216,216,216,0.3);

  /* Buttons — neutral gray gradient */
  --kap-btn-gradient: linear-gradient(135deg, #808080 0%, #606060 100%);
  --kap-btn-hover-shadow:
    0 4px 16px rgba(0,0,0,0.4),
    0 8px 24px rgba(255,255,255,0.05);
  --kap-btn-active-shadow: inset 0 2px 4px rgba(0,0,0,0.5);

  /* Atmosphere — no color, subtle neutral glow */
  --kap-orb-1: radial-gradient(ellipse 600px 400px at 10% 15%, rgba(255,255,255,0.015), transparent 70%);
  --kap-orb-2: radial-gradient(ellipse 500px 500px at 90% 50%, rgba(255,255,255,0.01), transparent 70%);
  --kap-orb-3: radial-gradient(ellipse 400px 300px at 50% 85%, rgba(255,255,255,0.008), transparent 70%);

  /* Extra color vars not in theme key system — ensure gray for components using them */
  --theme-orange: #C8C8C8;
  --theme-pink: #B0B0B0;
}

/* Grayscale: desaturate non-color-critical simulations and code blocks.
   Components with data-preserves-color keep their actual wavelength/spectrum colors. */
:root[data-theme="github-dark-dimmed"] .trace-viz:not([data-preserves-color]),
:root[data-theme="github-dark-dimmed"] .prose div.expressive-code {
  filter: grayscale(1);
}

/* Grayscale: override viz-specific vars for high-contrast charts */
:root[data-theme="github-dark-dimmed"] .trace-viz {
  /* Structure: subtle grid, visible axes */
  --viz-grid: #3D3D3D;
  --viz-axis: #909090;
  --viz-bg: #2A2A2A;

  /* Text: bright labels, readable muted */
  --viz-text: #D8D8D8;
  --viz-text-muted: #A0A0A0;

  /* Data curves: wide brightness spread for distinction */
  --viz-curve-planck: #E8E8E8;
  --viz-curve-classical: #909090;
  --viz-wien: #C8C8C8;
  --viz-catastrophe: #E0E0E0;

  /* Field/circuit components */
  --viz-positive: #E0E0E0;
  --viz-negative: #808080;
  --viz-coil: #D0D0D0;
  --viz-field: #808080;
  --viz-voltage: #B8B8B8;
  --viz-propagation: #C0C0C0;
  --viz-wire: #C8C8C8;
  --viz-electron: #A0A0A0;

  /* Neuron/action potential */
  --viz-waveform: #E0E0E0;
  --viz-na: #D8D8D8;
  --viz-k: #888888;
  --viz-resting: #C0C0C0;
  --viz-threshold: #A8A8A8;
  --viz-refractory: #909090;

  /* Timeline/general colors */
  --viz-accent: #B0B0B0;
  --viz-purple: #B0B0B0;
  --viz-yellow: #D0D0D0;
  --viz-orange: #C0C0C0;
  --viz-cyan: #A0A0A0;
  --viz-blue: #888888;
  --viz-red: #D8D8D8;
  --viz-green: #B8B8B8;
  --viz-pink: #A8A8A8;

  /* PhotoelectricEffect UI indicators (not wavelength data) */
  --viz-reject: #B0B0B0;
  --viz-accept: #A0A0A0;
  --viz-electron-fill: #909090;
}

/* Warm Parchment (light) — aged paper, no haze */
:root[data-theme="rose-pine-dawn"] {
  color-scheme: light;

  --kap-bg-from: #FAF6F1;
  --kap-bg-to: #F2EBE2;

  /* Surfaces — barely tinted, no glassmorphism fog */
  --kap-surface-bg: rgba(184, 96, 32, 0.035);
  --kap-surface-blur: 0px;

  /* Borders — crisp, architectural. Amber accent right edge like a book spine */
  --kap-border-right: rgba(184, 96, 32, 0.18);
  --kap-border-bottom: rgba(44, 26, 14, 0.1);
  --kap-border-top: rgba(250, 244, 236, 0.7);
  --kap-border-left: rgba(250, 244, 236, 0.4);

  /* Shadows — subtle but defined, not cloudy */
  --kap-shadow-card:
    0 1px 2px rgba(44,26,14,0.06),
    0 2px 8px rgba(44,26,14,0.04);
  --kap-shadow-button:
    0 1px 3px rgba(44,26,14,0.12),
    0 2px 6px rgba(184,96,32,0.08);

  --kap-text-shadow-title: none;
  --kap-text-secondary: rgba(44,26,14,0.65);
  --kap-text-tertiary: rgba(44,26,14,0.45);
  --kap-text-muted: rgba(44,26,14,0.3);

  /* Buttons — burnt sienna gradient */
  --kap-btn-gradient: linear-gradient(135deg, #B86020 0%, #9A4C18 100%);
  --kap-btn-hover-shadow:
    0 2px 8px rgba(44,26,14,0.12),
    0 4px 12px rgba(184,96,32,0.12);
  --kap-btn-active-shadow: inset 0 2px 3px rgba(44,26,14,0.2);

  /* Atmosphere — barely-there warmth */
  --kap-orb-1: radial-gradient(ellipse 600px 400px at 10% 15%, rgba(184,96,32,0.025), transparent 70%);
  --kap-orb-2: radial-gradient(ellipse 500px 500px at 90% 50%, rgba(154,122,32,0.02), transparent 70%);
  --kap-orb-3: radial-gradient(ellipse 400px 300px at 50% 85%, rgba(82,122,58,0.015), transparent 70%);
}

/* ==========================================================================
   Kapsicum — Glassmorphism Surfaces
   ========================================================================== */

/* Clean surfaces — no ::before haze, just material + borders */
.kap-surface {
  background: var(--kap-surface-bg);
  border-right: 1px solid var(--kap-border-right);
  border-bottom: 1px solid var(--kap-border-bottom);
  border-top: 1px solid var(--kap-border-top);
  border-left: 1px solid var(--kap-border-left);
  border-radius: 12px;
  box-shadow: var(--kap-shadow-card);
}

.kap-surface-interactive {
  background: var(--kap-surface-bg);
  border-right: 1px solid var(--kap-border-right);
  border-bottom: 1px solid var(--kap-border-bottom);
  border-top: 1px solid var(--kap-border-top);
  border-left: 1px solid var(--kap-border-left);
  border-radius: 12px;
  box-shadow: var(--kap-shadow-card);
  transition:
    transform 0.2s cubic-bezier(0.22, 1, 0.36, 1),
    box-shadow 0.2s cubic-bezier(0.22, 1, 0.36, 1);
}

@media (hover: hover) {
  .kap-surface-interactive:hover {
    transform: translateY(-3px);
    box-shadow: var(--kap-btn-hover-shadow);
  }
}

.kap-surface-interactive:active {
  transform: translateY(1px);
  box-shadow: var(--kap-btn-active-shadow);
  transition-duration: 60ms;
}

@media (hover: none) {
  .kap-surface-interactive:hover {
    transform: none;
  }
}

@media (prefers-reduced-motion: reduce) {
  .kap-surface-interactive {
    transition: none;
  }
}

/* Atmosphere layer */
.kap-atmosphere {
  view-transition-name: none;
}

header {
  view-transition-name: none;
}

@view-transition {
  navigation: auto;
}

* {
  /* Custom scrollbar styles */
  scrollbar-width: thin;
  scrollbar-color: color-mix(in oklab, var(--theme-accent) 20%, transparent) transparent;
}

html {
  /* Slightly more accented scrollbar for better visibility */
  scrollbar-color: color-mix(in oklab, var(--theme-accent) 30%, transparent) transparent !important;
  /* Prevents layout from jumping when opening theme select or search dialog menus */
  scrollbar-gutter: stable;
  scroll-behavior: smooth;
  overflow-x: clip;
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
}

/* Mobile uses overlay scrollbars — scrollbar-gutter wastes space */
@media (hover: none) {
  html {
    scrollbar-gutter: auto;
  }
}

body {
  @apply transition-colors;
  font-display: block;
  font-size-adjust: from-font var(--theme-font);
}

input:focus-visible,
textarea:focus-visible,
select:focus-visible,
button:focus-visible,
a:focus-visible,
input:active,
textarea:active,
select:active,
button:active {
  @apply outline-1 outline-accent outline-offset-2;
}

a,
button {
  @apply hover:cursor-pointer;
}

a {
  @apply underline-offset-2;
}

a.button {
  @apply inline-flex py-2 px-4 whitespace-nowrap rounded-xl font-semibold no-underline;
  background: var(--kap-btn-gradient);
  color: #fff;
  box-shadow: var(--kap-shadow-button);
  transition:
    transform 0.2s cubic-bezier(0.34, 1.2, 0.64, 1),
    box-shadow 0.2s cubic-bezier(0.34, 1.2, 0.64, 1);
}

@media (hover: hover) {
  a.button:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: var(--kap-btn-hover-shadow);
  }
}

a.button:active {
  transform: translateY(1px);
  box-shadow: var(--kap-btn-active-shadow);
  transition-duration: 60ms;
}

@media (prefers-reduced-motion: reduce) {
  a.button {
    transition: none;
  }
}

header button,
header input {
  @apply !outline-none;
}

button {
  @apply cursor-pointer;
}

article img {
  @apply block max-w-full rounded-xl overflow-hidden mx-auto;
  border-right: 1px solid var(--kap-border-right);
  border-bottom: 1px solid var(--kap-border-bottom);
  border-top: 1px solid var(--kap-border-top);
  border-left: 1px solid var(--kap-border-left);
  box-shadow: var(--kap-shadow-card);

  &[data-pixelated] {
    image-rendering: pixelated;
  }
}

.prose {
  @apply text-base/7;

  code:not(.expressive-code code) {
    @apply text-sm text-foreground/90 bg-foreground/5 px-2 py-1 rounded-lg whitespace-nowrap;
    font-family: var(--theme-font), monospace;
  }

  a:visited:not(.heading-anchor) {
    color: color-mix(in srgb, var(--theme-link) 65%, var(--theme-foreground));
  }

  & > *:not(div.expressive-code, img, figure, video, hr, blockquote, aside),
  figcaption {
    @apply md:mx-2;
  }

  div.expressive-code {
    @apply my-8;

    --ec-codeFontFml: var(--default-mono-font-family);

    /* Prevent italics in code blocks */
    /* Feel free to remove this if you want italics */
    div.code span {
      font-style: normal !important;
    }

    div.copy {
      --button-spacing: 9px;

      button {
        @apply flex;
        --code-background: var(--theme-background);
      }
    }

    figure {
      @apply !rounded-xl;
      border-right: 1px solid var(--kap-border-right) !important;
      border-bottom: 1px solid var(--kap-border-bottom) !important;
      border-top: 1px solid var(--kap-border-top) !important;
      border-left: 1px solid var(--kap-border-left) !important;
      box-shadow: var(--kap-shadow-card) !important;

      &.has-title div.copy,
      &.is-terminal div.copy {
        --button-spacing: 28px;
      }

      &.has-title.is-terminal {
        span.title {
          @apply !px-15;
        }
        --button-spacing: 30px !important;
      }

      figcaption {
        border-radius: 10px 10px 0 0 !important;
        background: transparent !important;
        padding-block: 0 !important;
        border: none !important;

        &::after,
        &::before {
          border: none !important;
        }

        span.title {
          @apply !text-foreground/90 !bg-foreground/8 text-center !border-b-2 !border-t-0 !border-r-0 !border-l-0 !border-foreground/10;
          width: 100%;
          font-family: var(--theme-font);
          font-size: var(--ec-codeFontSize);
          border-radius: 10px 10px 0 0 !important;
          border-bottom-width: 0 !important;
          padding: 0 12px !important;

          &::after,
          &::before {
            border: none !important;
          }
        }
      }

      & > pre {
        border-radius: 10px !important;
        border: none !important;
        scrollbar-width: thin;
        background: transparent !important;
      }
    }
  }

  blockquote,
  aside {
    div.expressive-code {
      @apply my-3;
    }
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply my-6.5 font-semibold;
    text-shadow: var(--kap-text-shadow-title);

    a {
      @apply underline-offset-3 text-inherit no-underline;
    }
  }

  h1 {
    @apply text-[1.75rem] text-heading1 mt-8;

    .heading-anchor svg {
      @apply size-5.5;
    }
  }

  h2 {
    @apply text-[1.6rem] text-heading2 mt-12;

    .heading-anchor svg {
      @apply size-5.5;
    }
  }

  h3 {
    @apply text-2xl text-heading3 mt-10;

    .heading-anchor svg {
      @apply size-5;
    }
  }

  h4 {
    @apply text-2xl text-heading4 mt-8;

    .heading-anchor svg {
      @apply size-5;
    }
  }

  h5 {
    @apply text-lg text-heading5;

    .heading-anchor svg {
      @apply size-4.5;
    }
  }

  h6 {
    @apply text-lg text-heading6;

    .heading-anchor svg {
      @apply size-4.5;
    }
  }

  p,
  ul,
  ol,
  img,
  figure,
  video,
  table,
  blockquote,
  aside {
    @apply my-6.5;
  }

  b,
  strong,
  th,
  button {
    @apply font-semibold;
  }

  a {
    @apply text-link underline hover:underline;

    &.heading-anchor {
      text-decoration: none;
      color: inherit;

      &:hover {
        text-decoration: underline;
      }
    }
  }

  button {
    @apply font-bold text-center text-accent py-1 px-4.5 border-4 border-accent rounded-xl cursor-pointer hover:bg-accent/15 transition-colors;
  }

  figure:not(.expressive-code figure) {
    @apply block mx-auto rounded-xl py-2;

    figcaption {
      @apply text-center italic;
    }
  }

  ul,
  ol {
    @apply pl-8 sm:pl-9.5;
  }

  li {
    @apply pl-2 my-4 marker:text-list;
  }

  ul li {
    list-style-type: '-';
  }

  ol li {
    @apply list-decimal;
  }

  hr {
    @apply h-0.5 my-16 bg-separator border-none rounded-xl;
  }

  blockquote,
  aside {
    @apply px-7 md:px-6 rounded-xl py-6;

    & > *:not(div.expressive-code, img, figure, video, hr),
    figcaption {
      @apply md:mx-2;
    }

    p:first-child {
      @apply mt-0;
    }

    p:last-child {
      @apply mb-0;
    }
  }

  blockquote {
    @apply relative before:content-['>'] before:block before:absolute before:text-accent before:font-bold before:left-3;
    background: var(--kap-surface-bg);
    border-right: 1px solid var(--kap-border-right);
    border-bottom: 1px solid var(--kap-border-bottom);
    border-top: 1px solid var(--kap-border-top);
    border-left: 1px solid var(--kap-border-left);
    box-shadow: var(--kap-shadow-card);
  }

  aside {
    background: var(--kap-surface-bg);
    border-right: 1px solid var(--kap-border-right);
    border-bottom: 1px solid var(--kap-border-bottom);
    border-top: 1px solid var(--kap-border-top);
    border-left: 1px solid var(--kap-border-left);
    box-shadow: var(--kap-shadow-card);

    p.admonition-title {
      @apply mb-2 inline-block font-semibold relative ml-6.5 md:ml-8.5;

      &:before {
        @apply size-4 bg-blue -left-6 top-1.5 absolute;
        content: '';
        mask-size: contain;
        mask-position: center;
        mask-repeat: no-repeat;
      }
    }

    p:not(.admonition-title):first-child {
      @apply mt-0;
    }

    &[data-admonition-type='note'] {
      @apply bg-note/7;

      p.admonition-title {
        @apply text-note;
      }

      p.admonition-title:before {
        @apply bg-note;
        mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z'%3E%3C/path%3E%3C/svg%3E");
      }
    }

    &[data-admonition-type='tip'] {
      @apply bg-tip/7;

      p.admonition-title {
        @apply text-tip;
      }

      p.admonition-title:before {
        @apply bg-tip;
        mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z'%3E%3C/path%3E%3C/svg%3E");
      }
    }

    &[data-admonition-type='important'] {
      @apply bg-important/7;

      p.admonition-title {
        @apply text-important;
      }

      p.admonition-title:before {
        @apply bg-important;
        mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z'%3E%3C/path%3E%3C/svg%3E");
      }
    }

    &[data-admonition-type='caution'] {
      @apply bg-caution/7;

      p.admonition-title {
        @apply text-caution;
      }

      p.admonition-title:before {
        @apply bg-caution;
        mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z'%3E%3C/path%3E%3C/svg%3E");
      }
    }

    &[data-admonition-type='warning'] {
      @apply bg-warning/7;

      p.admonition-title {
        @apply text-warning;
      }

      p.admonition-title:before {
        @apply bg-warning;
        mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath d='M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z'%3E%3C/path%3E%3C/svg%3E");
      }
    }
  }


  table {
    @apply border-2 p-2.5;
    border-color: var(--kap-border-bottom);
    display: block;
    overflow-x: auto;
    max-width: 100%;
    scrollbar-width: auto;
  }

  th,
  td {
    @apply border-2 p-2.5;
    border-color: var(--kap-border-bottom);
  }

  th {
    @apply uppercase text-left;
  }

  .katex-display {
    @apply overflow-x-auto;
  }

  fieldset {
    @apply inline-block border-2 border-accent/80 p-2.5 rounded-xl;
  }

  fieldset *:first-child {
    @apply mb-0;
  }

  fieldset input,
  fieldset select,
  fieldset textarea,
  fieldset label,
  fieldset button {
    @apply mt-3 w-full;
  }

  label {
    @apply inline-block;
  }

  label input {
    @apply mt-0;
  }

  input,
  textarea,
  select {
    @apply bg-transparent text-foreground border-1 border-foreground p-2.5 rounded-xl;
  }

  input[type='checkbox'] {
    @apply w-auto;
  }

  input[type='submit'] {
    @apply border-accent cursor-pointer;
  }
}

/* Skip to content link — hidden until focused */
.skip-to-content {
  position: fixed;
  top: -100%;
  left: 50%;
  transform: translateX(-50%);
  z-index: 999;
  padding: 8px 20px;
  border-radius: 0 0 8px 8px;
  background: var(--theme-accent);
  color: var(--theme-background);
  font-family: 'JetBrains Mono Variable', monospace;
  font-size: 13px;
  font-weight: 600;
  text-decoration: none;
  transition: top 0.15s ease;
}

.skip-to-content:focus {
  top: 0;
  outline: 2px solid var(--theme-accent);
  outline-offset: 2px;
}

/* Print stylesheet */
@media print {
  .skip-to-content,
  .kap-atmosphere,
  header,
  footer,
  .toc,
  .toc-mobile-trigger,
  .toc-mobile-backdrop,
  .toc-mobile-drawer,
  .reading-progress,
  .scroll-up-button,
  .series-context-nav,
  .theme-picker-wrap,
  nav[aria-label="Menu"] {
    display: none !important;
  }

  body {
    background: white !important;
    color: black !important;
  }

  .prose {
    max-width: 100% !important;
  }

  .prose a {
    color: inherit !important;
    text-decoration: underline !important;
  }

  .prose a::after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    opacity: 0.6;
  }

  .prose a[href^="#"]::after,
  .prose a.heading-anchor::after {
    content: none;
  }
}
