---
import type { GetStaticPaths } from 'astro'
import Layout from '~/layouts/Layout.astro'
import { SeriesGroup } from '~/utils'
import PageHeader from '~/components/PageHeader.astro'
import PostPreview from '~/components/PostPreview.astro'

export const getStaticPaths = (async () => {
  const seriesGroup = await SeriesGroup.build()
  return seriesGroup.collations.map((series) => {
    return {
      params: { slug: series.titleSlug },
      props: { posts: series.entries, seriesTitle: series.title },
    }
  })
}) satisfies GetStaticPaths

const { posts, seriesTitle } = Astro.props
---

<Layout
  title={`Series: ${seriesTitle}`}
  description={`All posts in the ${seriesTitle} series`}
>
  <div class="mt-2 sm:mt-0">
    <PageHeader titlePieces={['series', seriesTitle]} />
    <p class="text-foreground/50 text-sm italic mb-6">
      These posts are AI-assisted and written as a personal learning exercise. They may contain errors and shouldn't be treated as authoritative sources.
    </p>
    {posts.map((post) => <PostPreview post={post} />)}
  </div>
</Layout>
